apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "ldap-openfga-sync.fullname" . }}
  labels:
    {{- include "ldap-openfga-sync.labels" . | nindent 4 }}
data:
  # LDAP Configuration
  LDAP_SERVER: {{ .Values.ldap.server | quote }}
  LDAP_BIND_DN: {{ .Values.ldap.bindDn | quote }}
  LDAP_GROUP_BASE_DN: {{ .Values.ldap.groupBaseDn | quote }}
  LDAP_GROUP_FILTER: {{ .Values.ldap.groupFilter | quote }}
  LDAP_MEMBER_ATTRIBUTE: {{ .Values.ldap.memberAttribute | quote }}
  LDAP_USE_TLS: {{ .Values.ldap.useTls | quote }}
  # OpenFGA Configuration
  OPENFGA_API_URL: {{ .Values.openfga.apiUrl | quote }}
  {{- if .Values.openfga.authorizationModelId }}
  OPENFGA_AUTHORIZATION_MODEL_ID: {{ .Values.openfga.authorizationModelId | quote }}
  {{- end }}
  # Sync Configuration
  SYNC_DRY_RUN: {{ .Values.sync.dryRun | quote }}
  CRON_SCHEDULE: {{ .Values.sync.schedule | quote }}

